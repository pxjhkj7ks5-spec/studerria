<%
  const isSchedule = activePage === 'schedule';
  const isMyDay = activePage === 'my-day';
  const isProfile = activePage === 'profile';
  const isTeamwork = activePage === 'teamwork';
  const isSubjects = activePage === 'subjects';
  const isJournal = activePage === 'journal';
  const brandTitle = isSchedule ? 'Studerria' : (pageTitle || 'Studerria');
%>
<nav class="navbar navbar-expand-lg topbar">
  <div class="container">
    <span class="navbar-brand text-white me-auto"><%= brandTitle %></span>
    <div class="d-flex align-items-center gap-2 topbar-actions flex-wrap justify-content-end">
      <% if (isSchedule) { %>
        <span class="me-2 muted desktop-only text-nowrap">
          <% if (role === 'admin') { %>
            <%= t('role.admin') %>: <%= username %>
          <% } else if (role === 'starosta') { %>
            <%= t('role.starosta') %>: <%= username %>
          <% } else if (role === 'deanery') { %>
            <%= t('role.deanery') %>: <%= username %>
          <% } else if (role === 'teacher') { %>
            <%= t('role.teacher') %>: <%= username %>
          <% } else { %>
            <%= t('role.student') %>: <%= username %>
          <% } %>
        </span>
        <button
          class="theme-toggle-min drawer-menu-btn desktop-only"
          type="button"
          id="scheduleDrawerToggle"
          aria-label="Open menu"
          aria-controls="scheduleActionDrawer"
          aria-expanded="false"
        >
          ‚ò∞
          <span class="msg-badge d-none" id="messagesBadge">0</span>
        </button>
        <button
          class="theme-toggle-min mobile-menu-btn"
          type="button"
          data-bs-toggle="modal"
          data-bs-target="#mobileMenuModal"
          aria-label="Menu"
        >
          ‚ò∞
          <span class="msg-badge d-none" id="mobileMenuBadge">0</span>
        </button>
      <% } else if (isSubjects) { %>
        <button
          class="theme-toggle theme-toggle-min"
          type="button"
          id="themeToggle"
          aria-label="Toggle theme"
          data-light-label="‚òÄÔ∏è"
          data-dark-label="üåô"
        >
          üåô
        </button>
        <a class="btn btn-glass" href="/schedule">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –¥–æ —Ä–æ–∑–∫–ª–∞–¥—É</a>
      <% } else if (isTeamwork) { %>
        <button
          class="theme-toggle theme-toggle-min"
          type="button"
          id="themeToggle"
          aria-label="Toggle theme"
          data-light-label="‚òÄÔ∏è"
          data-dark-label="üåô"
        >
          üåô
        </button>
        <a class="btn btn-glass" href="/schedule">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –¥–æ —Ä–æ–∑–∫–ª–∞–¥—É</a>
      <% } else { %>
        <% if (!isMyDay) { %>
          <span class="me-2 muted desktop-only text-nowrap">
            <% if (role === 'admin') { %>
              <%= t('role.admin') %>: <%= username %>
            <% } else if (role === 'starosta') { %>
              <%= t('role.starosta') %>: <%= username %>
            <% } else if (role === 'deanery') { %>
              <%= t('role.deanery') %>: <%= username %>
            <% } else if (role === 'teacher') { %>
              <%= t('role.teacher') %>: <%= username %>
            <% } else { %>
              <%= t('role.student') %>: <%= username %>
            <% } %>
          </span>
          <% if (role === 'admin') { %>
            <form method="POST" action="/admin/switch-to-admin" class="me-1 desktop-only">
              <button class="btn btn-glass" type="submit"><%= t('schedule.backToAdmin') %></button>
            </form>
          <% } else if (hasCustomAdminPanelAccess) { %>
            <a class="btn btn-glass me-1 desktop-only" href="<%= customAdminPanelHref || '/admin' %>"><%= t('schedule.backToAdmin') %></a>
          <% } %>
          <% if (role === 'starosta') { %>
            <a class="btn btn-glass me-1 desktop-only" href="/starosta"><%= t('menu.starosta') %></a>
          <% } %>
          <% if (role === 'deanery') { %>
            <a class="btn btn-glass me-1 desktop-only" href="/deanery"><%= t('menu.deanery') %></a>
          <% } %>
        <% } %>
        <button
          class="theme-toggle theme-toggle-min me-1 desktop-only"
          type="button"
          id="themeToggle"
          aria-label="Toggle theme"
          data-light-label="‚òÄÔ∏è"
          data-dark-label="üåô"
        >
          üåô
        </button>
        <% if (!isMyDay && !isSubjects) { %>
          <a class="btn btn-glass me-1 desktop-only" href="/subjects">–ü—Ä–µ–¥–º–µ—Ç–∏</a>
        <% } %>
        <% if (!isMyDay && !isJournal) { %>
          <a class="btn btn-glass me-1 desktop-only" href="/journal">–ñ—É—Ä–Ω–∞–ª</a>
        <% } %>
        <% if (!isMyDay && !isTeamwork) { %>
          <a class="btn btn-glass me-1 desktop-only" href="/teamwork"><%= t('menu.teamwork') %></a>
        <% } %>
        <% if (isMyDay) { %>
          <a class="btn btn-glass me-1 desktop-only" href="/schedule">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –¥–æ —Ä–æ–∑–∫–ª–∞–¥—É</a>
        <% } else { %>
          <a class="btn btn-glass me-1 desktop-only" href="/my-day">–ú—ñ–π –¥–µ–Ω—å</a>
        <% } %>
        <% if (!isMyDay && !isProfile) { %>
          <a class="btn btn-glass me-1 desktop-only" href="/profile"><%= t('schedule.profile') %></a>
        <% } %>
        <% if (!isMyDay) { %>
          <form method="POST" action="/logout" class="desktop-only">
            <button class="btn btn-glass" type="submit"><%= t('schedule.logout') %></button>
          </form>
        <% } %>
        <button
          class="theme-toggle-min mobile-menu-btn"
          type="button"
          data-bs-toggle="modal"
          data-bs-target="#mobileMenuModal"
          aria-label="Menu"
        >
          ‚ò∞
          <span class="msg-badge d-none" id="mobileMenuBadge">0</span>
        </button>
      <% } %>
    </div>
  </div>
</nav>
